
<?php

namespace SecurityLabs\LaravelSecurityChecker\Scanners;

use RecursiveDirectoryIterator;
use RecursiveIteratorIterator;

class MalwareScanner extends BaseScanner
{
    public function run()
    {
        $this->cmd->info("\nðŸ¦  Malware Scan:");

        $directory = public_path();
        $iterator = new RecursiveIteratorIterator(
            new RecursiveDirectoryIterator($directory)
        );

        foreach ($iterator as $file) {
            if ($file->getExtension() === 'php') {
                $this->fail("Suspicious PHP file found in public/: " . $file->getPathname());
            }
        }

        $this->pass("Malware scan completed.");
    }
}
